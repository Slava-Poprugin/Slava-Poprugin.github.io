(function($){'use strict';$(window).on('load',function(){$('.preloader').fadeOut(100);});function counter(){var oTop;if($('.count').length!==0){oTop=$('.count').offset().top-window.innerHeight;}
if($(window).scrollTop()>oTop){$('.count').each(function(){var $this=$(this),countTo=$this.attr('data-count');$({countNum:$this.text()}).animate({countNum:countTo},{duration:1000,easing:'swing',step:function(){$this.text(Math.floor(this.countNum));},complete:function(){$this.text(this.countNum);}});});}}
$(window).on('scroll',function(){counter();});function smoothScroll(){$('a[href*="#"]').not('[href="#"]').not('[href="#0"]').on("click",function(event){if(location.pathname.replace(/^\//,'')==this.pathname.replace(/^\//,'')&&location.hostname==this.hostname){var target=$(this.hash);target=target.length?target:$('[name='+this.hash.slice(1)+']');if(target.length){event.preventDefault();$('html, body').animate({scrollTop:target.offset().top},1000,"easeInOutExpo",function(){var $target=$(target);$target.focus();if($target.is(":focus")){return false;}else{$target.attr('tabindex','-1');$target.focus();}});}}});jQuery.extend(jQuery.easing,{easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b;}});}
if(navigator.userAgent.indexOf('Opera Mini')==-1||navigator.userAgent.indexOf('UCBrowser')!=-1){smoothScroll();}
var backgroundSlide=$('#background-slide');backgroundSlide.owlCarousel({loop:true,items:1,dots:false,autoplay:true,autoplayTimeout:5000,animateOut:'fadeOut',nav:false,});$('.slider-prev-button').on("click",function(){backgroundSlide.trigger('prev.owl.carousel');});$('.slider-next-button').on("click",function(){backgroundSlide.trigger('next.owl.carousel');});function SliderBackground(){if($(".owl-full-width .slider").length){$(".owl-full-width .slider").each(function(){var $this=$(this);var img=$this.children(img);var imgSrc=img.attr("src");$this.css({backgroundImage:"url("+imgSrc+")",backgroundSize:"cover",backgroundPosition:"right center"});});}}
SliderBackground();$('#burger').on("click",function(){$(".fullscreen-nav-container").slideToggle(300);});$(".fullscreen-nav-holder a, .turn-home").on("click",function(){$("#burger").trigger("click");});$(window).on('scroll',function(){var counter=0;$('section').each(function(){if($(window).scrollTop()+80>=$(this).offset().top){$('.menu-item').removeClass('active');$(".menu-item."+counter).addClass("active");$(".mobile-menu-item").removeClass("active");$(".mobile-menu-item."+counter).addClass("active");}
++counter;});});function toggleLogoImg(id){var img=document.getElementById(id).src;if(img.indexOf('wolf-dark.svg')!=-1){document.getElementById(id).src="images/wolf.svg";}
else{document.getElementById(id).src="images/wolf-dark.svg";}}
$('.about-me').waypoint({handler:function(direction){$(".menu-container").toggleClass("menu-normal");$(".menu-item").toggleClass("menu-item-transparent");$(".desktop-menu .hvr-underline-from-left").toggleClass("dark");toggleLogoImg('desktop-logo');$(".mobile-menu").toggleClass("mobile-menu-fix");var a=$(".menu-link").attr("class");if(direction=="up"&&a=="menu-link active"){$(".menu-link").trigger("click");}}});$('.mobile-menu a').on("click",function(){$(".menu-link").toggleClass("active");$(".menu-slider").slideToggle(500);});$('.skill h3').waypoint({handler:function(direction){if(direction=="up"){$('.skillbar').each(function(){$(this).find('.skillbar-bar').css("width","0");});}else if(direction=="down"){$('.skillbar').each(function(){$(this).find('.skillbar-bar').animate({width:jQuery(this).attr('data-percent')},2000);});}},offset:'bottom-in-view'});if(document.getElementById('.filtr-container')){var filterizd=$('.filtr-container').filterizr();$(".portfolio-navigation li").on("click",function(){$(".portfolio-navigation li").removeClass("active");$(this).addClass("active");});$('.filtr-container').magnificPopup({type:'image',delegate:'a',gallery:{enabled:true},zoom:{enabled:true,duration:300,easing:'ease-in-out'}});$('.services').waypoint({handler:function(direction){if(direction=="down"){filterizd.filterizr('shuffle');}},offset:"bottom-in-view"});}
$(".owl-carousel").owlCarousel({items:1,loop:true,dots:true,autoplay:true,autoplayTimeout:5000});var vh=$(window).height();if(navigator.userAgent.indexOf('Opera Mini')!=-1){work.start();happyClient.start();projects.start();coffee.start();$('.skillbar').each(function(){$(this).find('.skillbar-bar').animate({width:jQuery(this).attr('data-percent')},0);});$("input").removeClass("form-control");$("input").css({"width":"100%","height":"50px","background":"#fff"});$(".navigation-icon").css("display","none");}
if(navigator.userAgent.indexOf('UCBrowser')!=-1){$(".navigation-icon").css("display","none");$(".fun-facts").css({"display":"table","margin":"auto"});work.start();happyClient.start();projects.start();coffee.start();$('.skillbar').each(function(){$(this).find('.skillbar-bar').animate({width:jQuery(this).attr('data-percent')},0);});}
if(navigator.appName=='Microsoft Internet Explorer'||!!(navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/rv:11/))||(typeof $.browser!=="undefined"&&$.browser.msie==1)){$(".header, .fullscreen-nav-container, .like-me, .contact").css("background-attachment","scroll");$(".fullscreen-nav-holder").css("width","100vw");}
var wow=new WOW({animateClass:'animated',offset:70,mobile:false});wow.init();$(".about-me-images").waypoint({handler:function(direction){$(".scroll-up").toggleClass("scroll-up-show");},offset:"bottom-in-view"});$(".sub-button").waypoint({handler:function(direction){$(".scroll-up").toggleClass("scroll-up-show");},offset:"bottom-in-view"});}(jQuery));jQuery.colorbox.settings.maxWidth='95%';jQuery.colorbox.settings.maxHeight='95%';var resizeTimer;function resizeColorBox()
{if(resizeTimer)clearTimeout(resizeTimer);resizeTimer=setTimeout(function(){if(jQuery('#cboxOverlay').is(':visible')){jQuery.colorbox.load(true);}},300);}
jQuery(window).resize(resizeColorBox);window.addEventListener("orientationchange",resizeColorBox,false);$('a.youtube').colorbox({iframe:true,width:"95%",height:"73%",href:function(){var videoId=new RegExp('[\\?&]v=([^&#]*)').exec(this.href);if(videoId&&videoId[1]){return 'https://youtube.com/embed/'+videoId[1]+'?autoplay=1&rel=0&wmode=transparent&enablejsapi=1&modestbranding=1';}}});$(document).on('cbox_open',function(){$('body').css({overflow:'hidden'});}).on('cbox_closed',function(){$('body').css({overflow:''});});(function(root,factory){if(typeof define==='function'&&define.amd){define('baselineRatio',[],function(){return(root.baselineRatio=factory());});}else if(typeof exports==='object'){module.exports=factory();}else{root.baselineRatio=factory();}}(this,function(){var baselineRatio=function(elem){elem=elem||document.body;var container=document.createElement('div');container.style.display="block";container.style.position="absolute";container.style.bottom="0";container.style.right="0";container.style.width="0px";container.style.height="0px";container.style.margin="0";container.style.padding="0";container.style.visibility="hidden";container.style.overflow="hidden";var small=document.createElement('span');var large=document.createElement('span');small.style.fontSize="0px";large.style.fontSize="2000px";small.innerHTML="X";large.innerHTML="X";container.appendChild(small);container.appendChild(large);elem.appendChild(container);var smalldims=small.getBoundingClientRect();var largedims=large.getBoundingClientRect();elem.removeChild(container);var baselineposition=smalldims.top-largedims.top;var height=largedims.height;return 1-(baselineposition/height);}
return baselineRatio;}));/*!
* classie v1.0.1
* class helper functions
* from bonzo https://github.com/ded/bonzo
* MIT license
*
* classie.has( elem, 'my-class' ) -> true/false
* classie.add( elem, 'my-new-class' )
* classie.remove( elem, 'my-unwanted-class' )
* classie.toggle( elem, 'my-class' )
*/(function(window){'use strict';function classReg(className){return new RegExp("(^|\\s+)"+className+"(\\s+|$)");}
var hasClass,addClass,removeClass;if('classList'in document.documentElement){hasClass=function(elem,c){return elem.classList.contains(c);};addClass=function(elem,c){elem.classList.add(c);};removeClass=function(elem,c){elem.classList.remove(c);};}
else{hasClass=function(elem,c){return classReg(c).test(elem.className);};addClass=function(elem,c){if(!hasClass(elem,c)){elem.className=elem.className+' '+c;}};removeClass=function(elem,c){elem.className=elem.className.replace(classReg(c),' ');};}
function toggleClass(elem,c){var fn=hasClass(elem,c)?removeClass:addClass;fn(elem,c);}
var classie={hasClass:hasClass,addClass:addClass,removeClass:removeClass,toggleClass:toggleClass,has:hasClass,add:addClass,remove:removeClass,toggle:toggleClass};if(typeof define==='function'&&define.amd){define(classie);}else if(typeof exports==='object'){module.exports=classie;}else{window.classie=classie;}})(window);function MultipleUnderline(element,underlineStyles,elementStyles){this.element=element;this.text=this.element.textContent;this.underlineStyles=underlineStyles;this.elementStyles=elementStyles;this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext('2d');this.ratio=window.devicePixelRatio;this.canvas.width=this.elementStyles.width*this.ratio;this.canvas.height=this.elementStyles.height*this.ratio;this.canvas.style.left=this.elementStyles.canvasLeft+'px';this.element.appendChild(this.canvas);this.canvas.style.width=this.elementStyles.width+'px';this.ctx.font=this.font=this.elementStyles.fontStyle+' '
+multiplyValue(this.elementStyles.fontSize,this.ratio)+' '
+this.elementStyles.fontFamily;this.multipleRedrawActive=false;if(is_chrome){this.elementStyles.lineHeight=this.elementStyles.lineHeight*this.ratio;}else{this.elementStyles.lineHeight=this.elementStyles.lineHeight*this.ratio;}
var dotWidth=this.ctx.measureText('.')['width'];if(this.underlineStyles['text-underline-width']=="auto"){this.strokeWidth=dotWidth/12;}else{this.strokeWidth=this.underlineStyles['text-underline-width'];this.strokeWidth=parseFloat(this.strokeWidth)*this.ratio;}
if(this.underlineStyles['text-underline-position']=="auto"){this.underlinePosition=parseFloat(this.elementStyles.fontSize)*this.ratio*(1-this.elementStyles.baselinePositionRatio+
this.elementStyles.baselinePositionRatio*0.5)
+this.strokeWidth/2;}else{var userUnderlinePosition=parseFloat(this.underlineStyles['text-underline-position']);this.underlinePosition=parseFloat(this.elementStyles.fontSize)*this.ratio*(1-this.elementStyles.baselinePositionRatio+
this.elementStyles.baselinePositionRatio*userUnderlinePosition)
+this.strokeWidth/2;}
var adjustValue=optimalStrokeWidthPos(this.strokeWidth,this.underlinePosition);this.strokeWidth=adjustValue.strokeWidth;this.underlinePosition=adjustValue.posY;this.lines=[];this.myStrings=[];var words=this.text.match(/[^\s-]+-?\s?/g);var line='';var linePositionY=0;var firstLineCount=0;for(var n=0;n<words.length;n++){if(words[n].match(/\s+$/)){var newWord=words[n].replace(/\s+$/,'');var testLine=line+newWord;var testLineMetrics=this.ctx.measureText(testLine);var testLineWidth=testLineMetrics.width;testLine=testLine+' ';}else{var testLine=line+words[n];var testLineMetrics=this.ctx.measureText(testLine);var testLineWidth=testLineMetrics.width;}
if(!firstLineCount){if(testLineWidth+this.elementStyles.textIndent*this.ratio>this.elementStyles.parentWidth*this.ratio&&n>0){if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:this.elementStyles.textIndent*this.ratio-0.2,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine)
line=words[n];linePositionY+=this.elementStyles.lineHeight;firstLineCount++;}else{line=testLine;}}else{if(testLineWidth>this.elementStyles.parentWidth*this.ratio&&n>0){if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:-0.2,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine);line=words[n];linePositionY+=this.elementStyles.lineHeight;}else{line=testLine;}}}
if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:-0.2,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine);for(var i=0;i<this.lines.length;i++){var tempLine=this.lines[i];var myString=new GuitarString(this.ctx,new Point(tempLine.lineTextIndent,tempLine.linePositionY+this.underlinePosition),new Point(tempLine.lineTextIndent+tempLine.lineMeasureWidth,tempLine.linePositionY+this.underlinePosition),this.strokeWidth,this.underlineStyles['text-underline-color'],this.ratio);this.myStrings.push(myString);}
this.drawUnderline();this.drawHoles();}
MultipleUnderline.prototype.drawUnderline=function(){for(var i=0;i<this.myStrings.length;i++){var tempString=this.myStrings[i];tempString.update();tempString.draw();}};MultipleUnderline.prototype.drawHoles=function(){for(var i=0;i<this.lines.length;i++){var tempLine=this.lines[i];this.ctx.globalCompositeOperation="destination-out";this.ctx.font=this.font;this.ctx.fillStyle='green';this.ctx.textBaseline='top';this.ctx.fillText(tempLine.lineText,tempLine.lineTextIndent,tempLine.linePositionY);this.ctx.lineWidth=2*this.ratio+this.strokeWidth*3.6;this.ctx.strokeStyle='blue';this.ctx.strokeText(tempLine.lineText,tempLine.lineTextIndent,tempLine.linePositionY);}}
MultipleUnderline.prototype.clear=function(){var lastMultipleRedrawActive=this.multipleRedrawActive;this.multipleRedrawActive=false;for(var i=0;i<this.myStrings.length;i++){var tempString=this.myStrings[i];if(tempString.redrawActive){this.multipleRedrawActive=true;}}
if(this.multipleRedrawActive){console.log('clear now!')
this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);}};MultipleUnderline.prototype.update=function(){};MultipleUnderline.prototype.draw=function(){if(this.multipleRedrawActive){this.drawUnderline();this.drawHoles();}};function MultipleUnderline(element,underlineStyles,elementStyles){this.element=element;this.text=this.element.textContent;this.underlineStyles=underlineStyles;this.elementStyles=elementStyles;this.canvas=document.createElement("canvas");this.canvas.width=this.elementStyles.width;this.canvas.height=this.elementStyles.height;this.canvas.style.left=this.elementStyles.canvasLeft+'px';this.element.appendChild(this.canvas);this.canvas.width=this.canvas.clientWidth;this.canvas.height=this.canvas.clientHeight+this.elementStyles.lineHeight;this.ctx=this.canvas.getContext('2d');this.ctx.font=this.font=this.elementStyles.fontStyle+' '+this.elementStyles.fontSize+' '+this.elementStyles.fontFamily;this.multipleRedrawActive=false;if(is_chrome){this.elementStyles.lineHeight=Math.floor(this.elementStyles.lineHeight);}
this.dotWidth=this.ctx.measureText('.')['width'];if(this.underlineStyles['text-underline-width']=="auto"){if(this.dotWidth/6<=2){this.strokeWidth=Math.round(this.dotWidth/3)/2;}else{this.strokeWidth=Math.round(this.dotWidth/6);}}else{this.strokeWidth=this.underlineStyles['text-underline-width'];this.strokeWidth=parseFloat(this.strokeWidth);}
this.underlinePosition=parseFloat(this.elementStyles.fontSize)*2;if(this.strokeWidth<=1||(this.strokeWidth%2&&this.strokeWidth>2)){this.underlinePosition=Math.round(this.underlinePosition-0.5)+0.5;}else{this.underlinePosition=Math.round(this.underlinePosition);}
this.lines=[];this.myStrings=[];var words=this.text.match(/[^\s-]+-?\s?/g);var line='';var linePositionY=0;var firstLineCount=0;for(var n=0;n<words.length;n++){if(words[n].match(/\s+$/)){var newWord=words[n].replace(/\s+$/,'');var testLine=line+newWord;var testLineMetrics=this.ctx.measureText(testLine);var testLineWidth=testLineMetrics.width;testLine=testLine+' ';}else{var testLine=line+words[n];var testLineMetrics=this.ctx.measureText(testLine);var testLineWidth=testLineMetrics.width;}
if(!firstLineCount){if(testLineWidth+this.elementStyles.textIndent>this.elementStyles.parentWidth&&n>0){if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:this.elementStyles.textIndent,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine)
line=words[n];linePositionY+=this.elementStyles.lineHeight;firstLineCount++;}else{line=testLine;}}else{if(testLineWidth>this.elementStyles.parentWidth&&n>0){if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:0,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine);line=words[n];linePositionY+=this.elementStyles.lineHeight;}else{line=testLine;}}}
if(line.match(/\s+$/)){var lineMetrics=this.ctx.measureText(line.replace(/\s+$/,''));var lineWidth=lineMetrics.width;}else{var lineMetrics=this.ctx.measureText(line);var lineWidth=lineMetrics.width;}
var tempLine={lineText:line,lineTextIndent:0,linePositionY:linePositionY,lineMeasureWidth:lineWidth}
this.lines.push(tempLine);for(var i=0;i<this.lines.length;i++){var tempLine=this.lines[i];var myString=new GuitarString(this.ctx,new Point(tempLine.lineTextIndent,tempLine.linePositionY+this.underlinePosition),new Point(tempLine.lineTextIndent+tempLine.lineMeasureWidth,tempLine.linePositionY+this.underlinePosition),this.strokeWidth,this.underlineStyles['text-underline-color'],1);this.myStrings.push(myString);}
this.drawUnderline();this.drawHoles();}
MultipleUnderline.prototype.clear=function(){var lastMultipleRedrawActive=this.multipleRedrawActive;this.multipleRedrawActive=false;for(var i=0;i<this.myStrings.length;i++){var tempString=this.myStrings[i];if(tempString.redrawActive){this.multipleRedrawActive=true;}}
if(this.multipleRedrawActive){console.log('clear now!')
this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);}};MultipleUnderline.prototype.update=function(){};MultipleUnderline.prototype.draw=function(){if(this.multipleRedrawActive){this.drawUnderline();this.drawHoles();}};MultipleUnderline.prototype.drawUnderline=function(){for(var i=0;i<this.myStrings.length;i++){var tempString=this.myStrings[i];tempString.update();tempString.draw();}};MultipleUnderline.prototype.drawHoles=function(){for(var i=0;i<this.lines.length;i++){var tempLine=this.lines[i];this.ctx.globalCompositeOperation="destination-out";this.ctx.font=this.font;this.ctx.fillStyle='green';this.ctx.textBaseline='top';this.ctx.fillText(tempLine.lineText,tempLine.lineTextIndent,tempLine.linePositionY);this.ctx.lineWidth=3+this.strokeWidth;this.ctx.strokeStyle='blue';this.ctx.strokeText(tempLine.lineText,tempLine.lineTextIndent,tempLine.linePositionY);}}
var multiplyValue=function(value,multiplier){var str=value;var m=multiplier;var result=str.match(/(\d*\.?\d*)(.*)/);return result[1]*m+result[2];}
var optimalStrokeWidthPos=function(strokeWidth,posY){if(strokeWidth<1){posY=Math.round(posY-0.5)+0.5;}else if(strokeWidth>=1){strokeWidth=Math.round(strokeWidth);if(strokeWidth%2){posY=Math.round(posY-0.5)+0.5;}else{posY=Math.round(posY);}}
return{strokeWidth:strokeWidth,posY:posY}}
function SingleUnderline(element,underlineStyles,elementStyles){this.element=element;this.text=this.element.textContent;this.underlineStyles=underlineStyles;this.elementStyles=elementStyles;this.redrawActive=false;this.canvas=document.createElement("canvas");this.ctx=this.canvas.getContext('2d');this.ratio=window.devicePixelRatio;this.canvas.width=this.elementStyles.width*this.ratio;this.canvas.height=this.elementStyles.height*this.ratio;this.element.appendChild(this.canvas);this.canvas.style.width=this.elementStyles.width+'px';this.ctx.font=this.font=this.elementStyles.fontStyle+' '
+multiplyValue(this.elementStyles.fontSize,this.ratio)+' '
+this.elementStyles.fontFamily;var dotWidth=this.ctx.measureText('.')['width'];if(this.underlineStyles['text-underline-width']=="auto"){this.strokeWidth=dotWidth/12;}else{this.strokeWidth=this.underlineStyles['text-underline-width'];this.strokeWidth=parseFloat(this.strokeWidth)*this.ratio;}
if(this.underlineStyles['text-underline-position']=="auto"){this.underlinePosition=parseFloat(this.elementStyles.height)*this.ratio*(1-this.elementStyles.baselinePositionRatio+
this.elementStyles.baselinePositionRatio*0.5)
+this.strokeWidth/2;}else{var userUnderlinePosition=parseFloat(this.underlineStyles['text-underline-position']);this.underlinePosition=parseFloat(this.elementStyles.height)*this.ratio*(1-this.elementStyles.baselinePositionRatio+
this.elementStyles.baselinePositionRatio*userUnderlinePosition)
+this.strokeWidth/2;}
var adjustValue=optimalStrokeWidthPos(this.strokeWidth,this.underlinePosition);this.strokeWidth=adjustValue.strokeWidth;this.underlinePosition=adjustValue.posY;textWidth=this.ctx.measureText(this.text).width;this.myString=new GuitarString(this.ctx,new Point(0,this.underlinePosition),new Point(textWidth,this.underlinePosition),this.strokeWidth,this.underlineStyles['text-underline-color'],this.ratio);this.drawHoles();}
SingleUnderline.prototype.drawUnderline=function(){this.myString.draw();}
SingleUnderline.prototype.drawHoles=function(){this.ctx.font=this.font;this.ctx.textBaseline='top';this.ctx.globalCompositeOperation="destination-out";this.ctx.lineWidth=2*this.ratio+this.strokeWidth*3.6;this.ctx.strokeStyle='blue';this.ctx.beginPath();this.ctx.strokeText(this.text,-0.2,0);this.ctx.fillStyle='green';this.ctx.beginPath();this.ctx.fillText(this.text,-0.2,0);}
SingleUnderline.prototype.clear=function(){this.redrawActive=this.myString.redrawActive;if(this.myString.redrawActive){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);}};SingleUnderline.prototype.update=function(){if(this.myString.redrawActive){this.myString.update();}};SingleUnderline.prototype.draw=function(){if(this.redrawActive){this.drawUnderline();this.drawHoles();}};var getElementStyles=function(element){var $this=element;var baselinePositionRatio=baselineRatio(element);var lineHeight=parseFloat(window.getComputedStyle($this,null).getPropertyValue("line-height"));var fontFamily=window.getComputedStyle($this,null).getPropertyValue("font-family");var fontSize=window.getComputedStyle($this,null).getPropertyValue("font-size");var fontStyle=window.getComputedStyle($this,null).getPropertyValue("font-style");var width=$this.getBoundingClientRect().width;var height=$this.getBoundingClientRect().height;var parentWidth=$this.parentNode.getBoundingClientRect().width;var offsetLeft=$this.offsetLeft;var parentOffsetLeft=$this.parentNode.offsetLeft;var canvasLeft=parentOffsetLeft-offsetLeft;var textIndent=offsetLeft-parentOffsetLeft;return{lineHeight:lineHeight,width:width,height:height,parentWidth:parentWidth,fontFamily:fontFamily,fontSize:fontSize,fontStyle:fontStyle,baselinePositionRatio:baselinePositionRatio,canvasLeft:canvasLeft,textIndent:textIndent}};window.requestAnimFrame=(function(callback){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,1000/60);};})();var myUnderlines=[];var myMultipleUnderlines=[];window.onload=function(){var underlineElements=document.querySelectorAll(".underline");for(var n=0;n<underlineElements.length;n++){var element=underlineElements[n];var underlineStyles={'text-underline-color':'#000','text-underline-position':'auto','text-underline-skip':true,'text-underline-width':'auto'}
var elementStyles=getElementStyles(element);if(elementStyles.height>elementStyles.lineHeight){var myUnderline=new MultipleUnderline(element,underlineStyles,elementStyles);myUnderlines.push(myUnderline);}else{var myUnderline=new SingleUnderline(element,underlineStyles,elementStyles);myUnderlines.push(myUnderline);}}}
function animate(){for(var i=0;i<myUnderlines.length;i++){var myUnderline=myUnderlines[i];myUnderline.clear();myUnderline.update();myUnderline.draw();}
requestAnimFrame(function(){animate();});}
animate();var is_chrome=navigator.userAgent.toLowerCase().indexOf('chrome')>-1;var circleCenter=function(startPoint,thirdPoint,endPoint){var dy1=thirdPoint.y-startPoint.y;var dx1=thirdPoint.x-startPoint.x;var dy2=endPoint.y-thirdPoint.y;var dx2=endPoint.x-thirdPoint.x;var aSlope=dy1/dx1;var bSlope=dy2/dx2;var centerX=(aSlope*bSlope*(startPoint.y-endPoint.y)+bSlope*(startPoint.x+thirdPoint.x)
-aSlope*(thirdPoint.x+endPoint.x))/(2*(bSlope-aSlope));var centerY=-1*(centerX-(startPoint.x+thirdPoint.x)/2)/aSlope+(startPoint.y+thirdPoint.y)/2;var r=dist(centerX,centerY,startPoint.x,startPoint.y)
return{x:centerX,y:centerY,r:r};}
var dist=function(x,y,x0,y0){return Math.sqrt((x-=x0)*x+(y-=y0)*y);};var Point=function(x,y){this.x=x;this.y=y;}
var intersects=function(a,b,c,d,p,q,r,s){var det,gamma,lambda;det=(c-a)*(s-q)-(r-p)*(d-b);if(det===0){return false;}else{lambda=((s-q)*(r-a)+(p-r)*(s-b))/det;gamma=((b-d)*(r-a)+(c-a)*(s-b))/det;return(0<lambda&&lambda<1)&&(0<gamma&&gamma<1);}};var musicLevel=function(startPoint,endPoint,ratio){var length=dist(startPoint.x,startPoint.y,endPoint.x,endPoint.y)/ratio;level=Math.floor(length/30);if(level>19){level=19;}
level=19-level
if(level<10){level='0'+level}
return level;};function GuitarString(ctx,startPoint,endPoint,strokeWidth,strokeColor,ratio){this.ctx=ctx;this.canvas=ctx.canvas;this.startPoint=startPoint;this.endPoint=endPoint;this.strokeWidth=strokeWidth;this.strokeColor=strokeColor;this.ratio=ratio;this.level=musicLevel(this.startPoint,this.endPoint,this.ratio);this.maxGrabDistance=this.strokeWidth*5;this.maxControlDistance=this.strokeWidth*10;this.ctx.lineWidth=this.strokeWidth;this.ctx.strokeStyle=this.strokeColor;this.ctx.beginPath();this.ctx.moveTo(this.startPoint.x,this.startPoint.y);this.ctx.lineTo(this.endPoint.x,this.endPoint.y);this.ctx.globalCompositeOperation="source-over";this.ctx.stroke();this.currentMouseX;this.currentMouseY;this.lastMouseX;this.lastMouseY;this.waveInitX=(this.startPoint.x+this.endPoint.x)/2;this.waveInitY=this.startPoint.y-this.maxControlDistance;this.waveCount=0;this.damping=0.9;this.thirdPoint=new Point((this.startPoint.x+this.endPoint.x)/2,this.startPoint.y);this.userInControl=false;this.userPlucked=false;this.waveInControl=false;this.waveFinished=false;this.initState=true;this.lastRedraw=false;this.redrawActive=false;var self=this;this.canvas.addEventListener('mouseover',function(event){self.mouseOver(self,event);},false);this.canvas.addEventListener('mousemove',function(event){self.mouseMove(self,event);},false);this.canvas.addEventListener("mouseleave",function(event){self.mouseLeave(self,event);},false);this.canvas.addEventListener("mouseout",function(event){self.mouseOut(self,event);},false);this.canvas.addEventListener("touchstart",function(event){self.touchDown(self,event);},false);this.canvas.addEventListener("touchmove",function(event){self.touchXY(self,event);},false);this.canvas.addEventListener("touchend",function(event){self.touchUp(self,event);},false);}
GuitarString.prototype.mouseOver=function(self,event){this.currentMouseX=event.layerX*this.ratio;this.currentMouseX=event.layerY*this.ratio;};GuitarString.prototype.mouseMove=function(self,event){this.lastMouseX=this.currentMouseX;this.lastMouseY=this.currentMouseY;this.currentMouseX=event.layerX*this.ratio;this.currentMouseY=event.layerY*this.ratio;var radius=circleCenter(new Point(this.startPoint.x,this.startPoint.y),new Point(this.currentMouseX,this.currentMouseY),new Point(this.endPoint.x,this.endPoint.y)).r;var currentWaveDistance=radius-Math.sqrt(Math.pow(radius,2)-Math.pow((Math.abs(this.endPoint.x-this.startPoint.x))/2,2));var lastRadius=circleCenter(new Point(this.startPoint.x,this.startPoint.y),new Point(this.lastMouseX,this.lastMouseY),new Point(this.endPoint.x,this.endPoint.y)).r;var lastWaveDistance=lastRadius-Math.sqrt(Math.pow(lastRadius,2)
-Math.pow((Math.abs(this.endPoint.x-this.startPoint.x))/2,2));var mouseInGrabRange=currentWaveDistance<this.maxGrabDistance&&this.currentMouseX>this.startPoint.x&&this.currentMouseX<this.endPoint.x;var lastMouseOutGrabRange=!(lastWaveDistance<this.maxGrabDistance&&this.lastMouseX>this.startPoint.x&&this.lastMouseX<this.endPoint.x);var mouseOutControlRange=!(currentWaveDistance<this.maxControlDistance&&this.currentMouseX>this.startPoint.x&&this.currentMouseX<this.endPoint.x);var lastMouseInControlRange=lastWaveDistance<this.maxControlDistance&&this.lastMouseX>this.startPoint.x&&this.lastMouseY<this.endPoint.x;var mouseCrossed=intersects(this.lastMouseX,this.lastMouseY,this.currentMouseX,this.currentMouseY,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y);if(mouseInGrabRange&&lastMouseOutGrabRange&&(!this.userInControl)){this.initState=false;this.userInControl=true;this.waveInControl=false;this.waveFinished=false;this.redrawActive=true;}else if(mouseOutControlRange&&lastMouseInControlRange&&this.userInControl){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.waveCount=0;this.waveInitX=(this.startPoint.x+this.endPoint.x)/2;this.waveInitY=this.endPoint.y+this.maxControlDistance;}
if((!this.userInControl)&&mouseCrossed){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.redrawActive=true;this.waveCount=0;this.waveInitX=(this.startPoint.x+this.endPoint.y)/2;this.waveInitY=this.endPoint.y+this.maxGrabDistance*2/3;}};GuitarString.prototype.mouseLeave=function(self,event){if(this.userInControl){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.redrawActive=true;this.waveCount=0;this.waveInitX=event.layerX*this.ratio;this.waveInitY=event.layerY*this.ratio;}};GuitarString.prototype.mouseOut=function(self,event){};GuitarString.prototype.touchDown=function(self,event){this.currentMouseX=event.layerX*this.ratio;this.currentMouseX=event.layerY*this.ratio;};GuitarString.prototype.touchXY=function(self,event){this.lastMouseX=this.currentMouseX;this.lastMouseY=this.currentMouseY;this.currentMouseX=event.layerX*this.ratio;this.currentMouseY=event.layerY*this.ratio;var radius=circleCenter(new Point(this.startPoint.x,this.startPoint.y),new Point(this.currentMouseX,this.currentMouseY),new Point(this.endPoint.x,this.endPoint.y)).r;var currentWaveDistance=radius-Math.sqrt(Math.pow(radius,2)-Math.pow((Math.abs(this.endPoint.x-this.startPoint.x))/2,2));var lastRadius=circleCenter(new Point(this.startPoint.x,this.startPoint.y),new Point(this.lastMouseX,this.lastMouseY),new Point(this.endPoint.x,this.endPoint.y)).r;var lastWaveDistance=lastRadius-Math.sqrt(Math.pow(lastRadius,2)
-Math.pow((Math.abs(this.endPoint.x-this.startPoint.x))/2,2));var mouseInGrabRange=currentWaveDistance<this.maxGrabDistance&&this.currentMouseX>this.startPoint.x&&this.currentMouseX<this.endPoint.x;var lastMouseOutGrabRange=!(lastWaveDistance<this.maxGrabDistance&&this.lastMouseX>this.startPoint.x&&this.lastMouseX<this.endPoint.x);var mouseOutControlRange=!(currentWaveDistance<this.maxControlDistance&&this.currentMouseX>this.startPoint.x&&this.currentMouseX<this.endPoint.x);var lastMouseInControlRange=lastWaveDistance<this.maxControlDistance&&this.lastMouseX>this.startPoint.x&&this.lastMouseY<this.endPoint.x;var mouseCrossed=intersects(this.lastMouseX,this.lastMouseY,this.currentMouseX,this.currentMouseY,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y);if(mouseInGrabRange&&lastMouseOutGrabRange&&(!this.userInControl)){this.initState=false;this.userInControl=true;this.waveInControl=false;this.waveFinished=false;this.redrawActive=true;}else if(mouseOutControlRange&&lastMouseInControlRange&&this.userInControl){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.waveCount=0;this.waveInitX=(this.startPoint.x+this.endPoint.x)/2;this.waveInitY=this.endPoint.y+this.maxControlDistance;play_multi_sound('audio'+this.level);}
if((!this.userInControl)&&mouseCrossed){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.redrawActive=true;this.waveCount=0;this.waveInitX=(this.startPoint.x+this.endPoint.y)/2;this.waveInitY=this.endPoint.y+this.maxGrabDistance*2/3;}};GuitarString.prototype.touchUp=function(self,event){if(this.userInControl){this.initState=false;this.userInControl=false;this.waveInControl=true;this.waveFinished=false;this.redrawActive=true;this.waveCount=0;this.waveInitX=event.layerX*this.ratio;this.waveInitY=event.layerY*this.ratio;}};GuitarString.prototype.clear=function(){};GuitarString.prototype.update=function(){if(this.userInControl){this.thirdPoint=new Point(this.currentMouseX,this.currentMouseY);}
if(this.waveInControl){var waveX=this.waveInitX;var waveY=this.startPoint.y+
(this.waveInitY-this.startPoint.y)*Math.cos(this.waveCount/6*Math.PI)*Math.pow(this.damping,this.waveCount);if(Math.pow(this.damping,this.waveCount)>0.01){this.thirdPoint=new Point(waveX,waveY);this.waveCount++;}else{this.waveInControl=false;this.waveFinished=true;this.lastRedraw=true;this.thirdPoint=new Point(waveX,waveY);}}}
GuitarString.prototype.draw=function(){if(this.lastRedraw){this.drawLine();this.lastRedraw=false;this.redrawActive=false;}else{this.drawArc(this.startPoint,this.thirdPoint,this.endPoint);}};GuitarString.prototype.drawLine=function(){this.ctx.lineWidth=this.strokeWidth;this.ctx.strokeStyle=this.strokeColor;this.ctx.beginPath();this.ctx.moveTo(this.startPoint.x,this.startPoint.y);this.ctx.lineTo(this.endPoint.x,this.endPoint.y);this.ctx.globalCompositeOperation="source-over";this.ctx.stroke();};GuitarString.prototype.drawArc=function(startPoint,thirdPoint,endPoint){var ctx=this.ctx;ctx.lineWidth=this.strokeWidth;ctx.strokeStyle=this.strokeColor;var centerObject=circleCenter(new Point(startPoint.x,startPoint.y),new Point(thirdPoint.x,thirdPoint.y),new Point(endPoint.x,endPoint.y));var centerX=centerObject.x;var centerY=centerObject.y;var r=centerObject.r
var angle=Math.atan2(centerX-startPoint.x,centerY-startPoint.y);if(!angle){ctx.beginPath();ctx.moveTo(startPoint.x,startPoint.y);ctx.lineTo(endPoint.x,endPoint.y);}else{if(angle>Math.PI/2){ctx.beginPath();ctx.arc(centerX,centerY,r,Math.PI*1.5-angle,Math.PI*1.5+angle,true);}else{ctx.beginPath();ctx.arc(centerX,centerY,r,Math.PI*1.5-angle,Math.PI*1.5+angle,false);}}
ctx.globalCompositeOperation="source-over";ctx.stroke();}